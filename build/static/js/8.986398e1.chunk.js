(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{717:function(e,t,n){var r=n(779),a=n(748),c=36e5,o=6e4,i=2,s=/[T ]/,u=/:/,l=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],p=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],h=/^-(\d{2})$/,v=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,g=/^-?W(\d{2})-?(\d{1})$/,y=/^(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,O=/^(Z)$/,L=/^([+-])(\d{2})$/,E=/^([+-])(\d{2}):?(\d{2})$/;function k(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(a(e))return new Date(e.getTime());if("string"!==typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var D=function(e){var t,n={},r=e.split(s);if(u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=w.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),S=function(e,t){var n,r=d[t],a=f[t];if(n=p.exec(e)||a.exec(e)){var c=n[1];return{year:parseInt(c,10),restDateString:e.slice(c.length)}}if(n=l.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(D.date,n),T=S.year,C=function(e,t){if(null===t)return null;var n,r,a,c;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=h.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=v.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=m.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var i=parseInt(n[2],10);return r.setUTCFullYear(t,a,i),r}if(n=b.exec(e))return c=parseInt(n[1],10)-1,k(t,c);if(n=g.exec(e)){c=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return k(t,c,s)}return null}(S.restDateString,T);if(C){var F,I=C.getTime(),U=0;if(D.time&&(U=function(e){var t,n,r;if(t=y.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*c;if(t=x.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*c+r*o;if(t=j.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return n%24*c+r*o+1e3*a}return null}(D.time)),D.timezone)F=function(e){var t,n;return(t=O.exec(e))?0:(t=L.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=E.exec(e))?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0}(D.timezone)*o;else{var $=I+U,R=new Date($);F=r(R);var B=new Date($);B.setDate(R.getDate()+1);var q=r(B)-r(R);q>0&&(F+=q)}return new Date(I+U+F)}return new Date(e)}},723:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return o});var r=n(232),a=function(){return{type:r.c}},c=function(){return{type:r.b}},o=function(){return{type:r.a}}},726:function(e,t,n){"use strict";var r=n(1),a=n.n(r),c=n(110);t.a=function(e){var t=e.input,n=e.width,r=e.type,o=e.placeholder,i=e.meta,s=i.touched,u=i.error;return a.a.createElement(c.i.Field,{error:s&&!!u,width:n},a.a.createElement("input",Object.assign({},t,{placeholder:o,width:n,type:r})),s&&u&&a.a.createElement(c.o,{basic:!0,color:"red"},u))}},728:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u});var r=n(26),a=n(44),c=n(722),o=n.n(c),i=function(e){if(e)return Array.isArray(e)?Object.entries(e[0]).map(function(e){return Object.assign(e[1],{id:e[0]})}):Object.entries(e).map(function(e){return Object.assign(e[1],{id:e[0]})})},s=function(e,t,n){return n.date=o()(n.date).toDate(),Object(a.a)({},n,{hostUid:e.uid,hostedBy:e.displayName,hostPhotoURL:t||"/assets/user.png",created:o()(Date.now()).toDate(),attendees:Object(r.a)({},e.uid,{going:!0,joinDate:Date.now(),photoURL:t||"/assets/user.png",displayName:e.displayName,host:!0})})},u=function(e){var t=Object.create(null);e.forEach(function(e){return t[e.id]=Object(a.a)({},e,{childNodes:[]})});var n=[];return e.forEach(function(e){e.parentId?t[e.parentId].childNodes.push(t[e.id]):n.push(t[e.id])}),n}},729:function(e,t,n){var r=n(717);e.exports=function(e,t){var n=r(e).getTime(),a=r(t).getTime();return n<a?-1:n>a?1:0}},734:function(e,t,n){"use strict";n.d(t,"c",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return g}),n.d(t,"d",function(){return y}),n.d(t,"a",function(){return x});var r=n(44),a=n(720),c=n.n(a),o=n(721),i=n(127),s=n(220),u=n(723),l=n(728),d=n(722),p=n.n(d),f=n(265),h=n(729),v=n.n(h),m=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,r,a){var o,s,u,d,p,f;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.getFirestore,s=o(),u=s.auth().currentUser,d=r().firebase.profile.photoURL,p=Object(l.b)(u,d,e),t.prev=5,t.next=8,s.add("events",p);case 8:return f=t.sent,t.next=11,s.set("event_attendee/".concat(f.id,"_").concat(u.uid),{eventId:f.id,userUid:u.uid,eventDate:e.date,host:!0});case 11:i.toastr.success("Success!","Event has been created"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(5),i.toastr.error("Oops!","Something went wrong");case 17:case"end":return t.stop()}},t,this,[[5,14]])}));return function(e,n,r){return t.apply(this,arguments)}}()},b=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,r){var a,o,s,l,d,h,m,b;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n(Object(u.c)()),a=f.a.firestore(),e.date!==r().firestore.ordered.events[0].date&&(e.date=p()(e.date).toDate()),t.prev=3,o=a.collection("events").doc(e.id),0===v()(r().firestore.ordered.events[0].date.toDate(),e.date)){t.next=31;break}return s=a.batch(),t.next=10,s.update(o,e);case 10:return l=a.collection("event_attendee"),t.next=13,l.where("eventId","==",e.id);case 13:return d=t.sent,t.next=16,d.get();case 16:h=t.sent,m=0;case 18:if(!(m<h.docs.length)){t.next=27;break}return t.next=21,a.collection("event_attendee").doc(h.docs[m].id);case 21:return b=t.sent,t.next=24,s.update(b,{eventDate:e.date});case 24:m++,t.next=18;break;case 27:return t.next=29,s.commit();case 29:t.next=33;break;case 31:return t.next=33,o.update(e);case 33:n(Object(u.b)()),i.toastr.success("Success!","Event has been updated"),t.next=41;break;case 37:t.prev=37,t.t0=t.catch(3),n(Object(u.a)()),i.toastr.error("Oops!","Something went wrong");case 41:case"end":return t.stop()}},t,this,[[3,37]])}));return function(e,n){return t.apply(this,arguments)}}()},g=function(e,t){return function(){var n=Object(o.a)(c.a.mark(function n(r,a,o){var s,u,l;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:s=o.getFirestore,u=s(),l=e?"Are you sure to cancel the event?":"This will reactive the event - are you sure?";try{i.toastr.confirm(l,{onOk:function(){return u.update("events/".concat(t),{cancelled:e})}})}catch(r){console.log(r)}case 4:case"end":return n.stop()}},n,this)}));return function(e,t,r){return n.apply(this,arguments)}}()},y=function(e){return function(){var t=Object(o.a)(c.a.mark(function t(n,a){var o,i,l,d,p,h,v,m,b;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new Date(Date.now()),i=f.a.firestore(),l=i.collection("events"),t.prev=3,n(Object(u.c)()),t.t0=e,!t.t0){t.next=10;break}return t.next=9,i.collection("events").doc(e.id).get();case 9:t.t0=t.sent;case 10:return d=t.t0,p=e?l.where("date",">=",o).orderBy("date").startAfter(d).limit(2):l.where("date",">=",o).orderBy("date").limit(2),t.next=14,p.get();case 14:if(0!==(h=t.sent).docs.length){t.next=18;break}return n(Object(u.b)()),t.abrupt("return",h);case 18:for(v=[],m=0;m<h.docs.length;m++)b=Object(r.a)({},h.docs[m].data(),{id:h.docs[m].id}),v.push(b);return n({type:s.c,payload:{events:v}}),n(Object(u.b)()),t.abrupt("return",h);case 25:t.prev=25,t.t1=t.catch(3),console.log(t.t1),n(Object(u.a)());case 29:case"end":return t.stop()}},t,this,[[3,25]])}));return function(e,n){return t.apply(this,arguments)}}()},x=function(e,t,n){return function(){var r=Object(o.a)(c.a.mark(function r(a,o,s){var u,l,d,p,f;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u=s.getFirebase,l=u(),d=o().firebase.profile,p=l.auth().currentUser,f={parentId:n,displayName:d.displayName,photoURL:d.photoURL||"/assets/user.png",uid:p.uid,text:t.comment,date:Date.now()},r.prev=5,r.next=8,l.push("event_chat/".concat(e),f);case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(5),console.log(r.t0),i.toastr.error("Oops","Problem adding comment");case 14:case"end":return r.stop()}},r,this,[[5,10]])}));return function(e,t,n){return r.apply(this,arguments)}}()}},740:function(e,t,n){"use strict";var r=n(1),a=n.n(r),c=n(110);t.a=function(e){var t=e.input,n=e.rows,r=(e.type,e.placeholder),o=e.meta,i=o.touched,s=o.error;return a.a.createElement(c.i.Field,{error:i&&!!s},a.a.createElement("textarea",Object.assign({},t,{placeholder:r,rows:n})),i&&s&&a.a.createElement(c.o,{basic:!0,color:"red"},s))}},748:function(e,t){e.exports=function(e){return e instanceof Date}},750:function(e,t,n){"use strict";var r=n(44),a=n(123),c=n(124),o=n(229),i=n(125),s=n(230),u=n(1),l=n.n(u),d=n(110),p=n(789),f=n.n(p),h=n(788),v=n.n(h),m={autocompleteContainer:{zIndex:1e3}},b=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(n=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={scriptLoaded:!1},n.handleScriptLoaded=function(){return n.setState({scriptLoaded:!0})},n}return Object(s.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.input,n=e.width,a=e.onSelect,c=e.placeholder,o=e.options,i=e.meta,s=i.touched,u=i.error;return l.a.createElement(d.i.Field,{error:s&&!!u,width:n},l.a.createElement(f.a,{url:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgaL61tZqLxRUjDq1KaBZXk7hENz3ghTs&libraries=places",onLoad:this.handleScriptLoaded}),this.state.scriptLoaded&&l.a.createElement(v.a,{inputProps:Object(r.a)({},t,{placeholder:c}),options:o,onSelect:a,styles:m}),s&&u&&l.a.createElement(d.o,{basic:!0,color:"red"},u))}}]),t}(u.Component);t.a=b},779:function(e,t){e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},810:function(e,t,n){"use strict";var r=n(1),a=n.n(r),c=n(110);t.a=function(e){var t=e.input,n=(e.type,e.placeholder),r=e.multiple,o=e.options,i=e.meta,s=i.touched,u=i.error;return a.a.createElement(c.i.Field,{error:s&&!!u},a.a.createElement(c.u,{value:t.value||null,onChange:function(e,n){return t.onChange(n.value)},placeholder:n,multiple:r,options:o}),s&&u&&a.a.createElement(c.o,{basic:!0,color:"red"},u))}},811:function(e,t,n){"use strict";var r=n(730),a=n(1),c=n.n(a),o=n(110),i=n(828),s=(n(819),n(722)),u=n.n(s);t.a=function(e){var t=e.input,n=t.value,a=t.onChange,s=t.onBlur,l=Object(r.a)(t,["value","onChange","onBlur"]),d=e.width,p=e.placeholder,f=e.meta,h=f.touched,v=f.error,m=Object(r.a)(e,["input","width","placeholder","meta"]);return n&&(n=u()(n,"X")),c.a.createElement(o.i.Field,{error:h&&!!v,width:d},c.a.createElement(i.a,Object.assign({},m,{placeholderText:p,selected:n?u()(n):null,onChange:a,onBlur:function(){return s()}},l)),h&&v&&c.a.createElement(o.o,{basic:!0,color:"red"},v))}},896:function(e,t,n){"use strict";n.r(t);var r=n(720),a=n.n(r),c=n(721),o=n(123),i=n(124),s=n(229),u=n(125),l=n(230),d=n(1),p=n.n(d),f=n(126),h=n(219),v=n(207),m=n(206),b=n(788),g=n(789),y=n.n(g),x=n(749),j=n(110),w=n(734),O=n(726),L=n(740),E=n(810),k=n(811),D=n(750),S={createEvent:w.c,updateEvent:w.e,cancelToggle:w.b},T=Object(x.combineValidators)({title:Object(x.isRequired)({message:"The event title is required"}),category:Object(x.isRequired)({message:"Please provide a category"}),description:Object(x.composeValidators)(Object(x.isRequired)({message:"Please enter a description"}),Object(x.hasLengthGreaterThan)(4)({message:"Description needs to be at least 5 characters"}))(),city:Object(x.isRequired)("city"),venue:Object(x.isRequired)("venue"),date:Object(x.isRequired)("date")}),C=[{key:"drinks",text:"Drinks",value:"drinks"},{key:"culture",text:"Culture",value:"culture"},{key:"film",text:"Film",value:"film"},{key:"food",text:"Food",value:"food"},{key:"music",text:"Music",value:"music"},{key:"travel",text:"Travel",value:"travel"}],F=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={cityLatLng:{},venueLatLng:{},scriptLoaded:!1},n.handleScriptLoaded=function(){return n.setState({scriptLoaded:!0})},n.handleCitySelect=function(e){Object(b.geocodeByAddress)(e).then(function(e){return Object(b.getLatLng)(e[0])}).then(function(e){n.setState({cityLatLng:e})}).then(function(){n.props.change("city",e)})},n.handleVenueSelect=function(e){Object(b.geocodeByAddress)(e).then(function(e){return Object(b.getLatLng)(e[0])}).then(function(e){n.setState({venueLatLng:e})}).then(function(){n.props.change("venue",e)})},n.onFormSubmit=function(){var e=Object(c.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.venueLatLng=n.state.venueLatLng,!n.props.initialValues.id){e.next=8;break}return 0===Object.keys(t.venueLatLng).length&&(t.venueLatLng=n.props.event.venueLatLng),e.next=5,n.props.updateEvent(t);case 5:n.props.history.goBack(),e.next=10;break;case 8:n.props.createEvent(t),n.props.history.push("/events");case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.firestore,r=t.match,e.next=3,n.setListener("events/".concat(r.params.id));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.firestore,r=t.match,e.next=3,n.unsetListener("events/".concat(r.params.id));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.invalid,r=e.submitting,a=e.pristine,c=e.event,o=e.cancelToggle;return p.a.createElement(j.j,null,p.a.createElement(y.a,{url:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgaL61tZqLxRUjDq1KaBZXk7hENz3ghTs&libraries=places",onLoad:this.handleScriptLoaded}),p.a.createElement(j.j.Column,{width:10},p.a.createElement(j.t,null,p.a.createElement(j.k,{sub:!0,color:"teal",content:"Event Details"}),p.a.createElement(j.i,{onSubmit:this.props.handleSubmit(this.onFormSubmit)},p.a.createElement(v.a,{name:"title",type:"text",component:O.a,placeholder:"Give your event a name"}),p.a.createElement(v.a,{name:"category",type:"text",component:E.a,options:C,placeholder:"What is your event about"}),p.a.createElement(v.a,{name:"description",type:"text",rows:3,component:L.a,placeholder:"Tell us about your event"}),p.a.createElement(j.k,{sub:!0,color:"teal",content:"Event Location Details"}),p.a.createElement(v.a,{name:"city",type:"text",component:D.a,options:{types:["(cities)"]},placeholder:"Event City",onSelect:this.handleCitySelect}),this.state.scriptLoaded&&p.a.createElement(v.a,{name:"venue",type:"text",component:D.a,options:{location:new google.maps.LatLng(this.state.cityLatLng),radius:1e3,types:["establishment"]},placeholder:"Event Venue",onSelect:this.handleVenueSelect}),p.a.createElement(v.a,{name:"date",type:"text",component:k.a,dateFormat:"YYYY-MM-DD HH:mm",timeFormat:"HH:mm",showTimeSelect:!0,placeholder:"Date and Time of Event"}),p.a.createElement(j.a,{loading:t,disabled:n||r||a,positive:!0,type:"submit"},"Submit"),p.a.createElement(j.a,{disabled:t,onClick:this.props.history.goBack,type:"button"},"Cancel"),c.id&&p.a.createElement(j.a,{onClick:function(){return o(!c.cancelled,c.id)},type:"button",color:c.cancelled?"green":"red",floated:"right",content:c.cancelled?"Reactivate Event":"Cancel Event"})))))}}]),t}(d.Component);t.default=Object(h.withFirestore)(Object(f.connect)(function(e){var t={};return e.firestore.ordered.events&&e.firestore.ordered.events[0]&&(t=e.firestore.ordered.events[0]),{initialValues:t,event:t,loading:e.async.loading}},S)(Object(m.a)({form:"eventForm",enableReinitialize:!0,validate:T})(F)))}}]);
//# sourceMappingURL=8.986398e1.chunk.js.map