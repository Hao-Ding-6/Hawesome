(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{723:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});var r=n(232),a=function(){return{type:r.c}},o=function(){return{type:r.b}},s=function(){return{type:r.a}}},728:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(26),a=n(44),o=n(722),s=n.n(o),i=function(e){if(e)return Array.isArray(e)?Object.entries(e[0]).map(function(e){return Object.assign(e[1],{id:e[0]})}):Object.entries(e).map(function(e){return Object.assign(e[1],{id:e[0]})})},c=function(e,t,n){return n.date=s()(n.date).toDate(),Object(a.a)({},n,{hostUid:e.uid,hostedBy:e.displayName,hostPhotoURL:t||"/assets/user.png",created:s()(Date.now()).toDate(),attendees:Object(r.a)({},e.uid,{going:!0,joinDate:Date.now(),photoURL:t||"/assets/user.png",displayName:e.displayName,host:!0})})},u=function(e){var t=Object.create(null);e.forEach(function(e){return t[e.id]=Object(a.a)({},e,{childNodes:[]})});var n=[];return e.forEach(function(e){e.parentId?t[e.parentId].childNodes.push(t[e.id]):n.push(t[e.id])}),n}},734:function(e,t,n){"use strict";n.d(t,"c",function(){return m}),n.d(t,"e",function(){return b}),n.d(t,"b",function(){return y}),n.d(t,"d",function(){return g}),n.d(t,"a",function(){return E});var r=n(44),a=n(720),o=n.n(a),s=n(721),i=n(127),c=n(220),u=n(723),l=n(728),d=n(722),p=n.n(d),h=n(265),f=n(729),v=n.n(f),m=function(e){return function(){var t=Object(s.a)(o.a.mark(function t(n,r,a){var s,c,u,d,p,h;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=a.getFirestore,c=s(),u=c.auth().currentUser,d=r().firebase.profile.photoURL,p=Object(l.b)(u,d,e),t.prev=5,t.next=8,c.add("events",p);case 8:return h=t.sent,t.next=11,c.set("event_attendee/".concat(h.id,"_").concat(u.uid),{eventId:h.id,userUid:u.uid,eventDate:e.date,host:!0});case 11:i.toastr.success("Success!","Event has been created"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(5),i.toastr.error("Oops!","Something went wrong");case 17:case"end":return t.stop()}},t,this,[[5,14]])}));return function(e,n,r){return t.apply(this,arguments)}}()},b=function(e){return function(){var t=Object(s.a)(o.a.mark(function t(n,r){var a,s,c,l,d,f,m,b;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n(Object(u.c)()),a=h.a.firestore(),e.date!==r().firestore.ordered.events[0].date&&(e.date=p()(e.date).toDate()),t.prev=3,s=a.collection("events").doc(e.id),0===v()(r().firestore.ordered.events[0].date.toDate(),e.date)){t.next=31;break}return c=a.batch(),t.next=10,c.update(s,e);case 10:return l=a.collection("event_attendee"),t.next=13,l.where("eventId","==",e.id);case 13:return d=t.sent,t.next=16,d.get();case 16:f=t.sent,m=0;case 18:if(!(m<f.docs.length)){t.next=27;break}return t.next=21,a.collection("event_attendee").doc(f.docs[m].id);case 21:return b=t.sent,t.next=24,c.update(b,{eventDate:e.date});case 24:m++,t.next=18;break;case 27:return t.next=29,c.commit();case 29:t.next=33;break;case 31:return t.next=33,s.update(e);case 33:n(Object(u.b)()),i.toastr.success("Success!","Event has been updated"),t.next=41;break;case 37:t.prev=37,t.t0=t.catch(3),n(Object(u.a)()),i.toastr.error("Oops!","Something went wrong");case 41:case"end":return t.stop()}},t,this,[[3,37]])}));return function(e,n){return t.apply(this,arguments)}}()},y=function(e,t){return function(){var n=Object(s.a)(o.a.mark(function n(r,a,s){var c,u,l;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:c=s.getFirestore,u=c(),l=e?"Are you sure to cancel the event?":"This will reactive the event - are you sure?";try{i.toastr.confirm(l,{onOk:function(){return u.update("events/".concat(t),{cancelled:e})}})}catch(r){console.log(r)}case 4:case"end":return n.stop()}},n,this)}));return function(e,t,r){return n.apply(this,arguments)}}()},g=function(e){return function(){var t=Object(s.a)(o.a.mark(function t(n,a){var s,i,l,d,p,f,v,m,b;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new Date(Date.now()),i=h.a.firestore(),l=i.collection("events"),t.prev=3,n(Object(u.c)()),t.t0=e,!t.t0){t.next=10;break}return t.next=9,i.collection("events").doc(e.id).get();case 9:t.t0=t.sent;case 10:return d=t.t0,p=e?l.where("date",">=",s).orderBy("date").startAfter(d).limit(2):l.where("date",">=",s).orderBy("date").limit(2),t.next=14,p.get();case 14:if(0!==(f=t.sent).docs.length){t.next=18;break}return n(Object(u.b)()),t.abrupt("return",f);case 18:for(v=[],m=0;m<f.docs.length;m++)b=Object(r.a)({},f.docs[m].data(),{id:f.docs[m].id}),v.push(b);return n({type:c.c,payload:{events:v}}),n(Object(u.b)()),t.abrupt("return",f);case 25:t.prev=25,t.t1=t.catch(3),console.log(t.t1),n(Object(u.a)());case 29:case"end":return t.stop()}},t,this,[[3,25]])}));return function(e,n){return t.apply(this,arguments)}}()},E=function(e,t,n){return function(){var r=Object(s.a)(o.a.mark(function r(a,s,c){var u,l,d,p,h;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u=c.getFirebase,l=u(),d=s().firebase.profile,p=l.auth().currentUser,h={parentId:n,displayName:d.displayName,photoURL:d.photoURL||"/assets/user.png",uid:p.uid,text:t.comment,date:Date.now()},r.prev=5,r.next=8,l.push("event_chat/".concat(e),h);case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(5),console.log(r.t0),i.toastr.error("Oops","Problem adding comment");case 14:case"end":return r.stop()}},r,this,[[5,10]])}));return function(e,t,n){return r.apply(this,arguments)}}()}},782:function(e,t,n){var r=n(783),a=n(717),o=n(784),s=n(786),i=n(781),c=1440,u=2520,l=43200,d=86400;e.exports=function(e,t,n){var p=n||{},h=r(e,t),f=p.locale,v=i.distanceInWords.localize;f&&f.distanceInWords&&f.distanceInWords.localize&&(v=f.distanceInWords.localize);var m,b,y={addSuffix:Boolean(p.addSuffix),comparison:h};h>0?(m=a(e),b=a(t)):(m=a(t),b=a(e));var g,E=o(b,m),O=b.getTimezoneOffset()-m.getTimezoneOffset(),w=Math.round(E/60)-O;if(w<2)return p.includeSeconds?E<5?v("lessThanXSeconds",5,y):E<10?v("lessThanXSeconds",10,y):E<20?v("lessThanXSeconds",20,y):E<40?v("halfAMinute",null,y):v(E<60?"lessThanXMinutes":"xMinutes",1,y):0===w?v("lessThanXMinutes",1,y):v("xMinutes",w,y);if(w<45)return v("xMinutes",w,y);if(w<90)return v("aboutXHours",1,y);if(w<c)return v("aboutXHours",Math.round(w/60),y);if(w<u)return v("xDays",1,y);if(w<l)return v("xDays",Math.round(w/c),y);if(w<d)return v("aboutXMonths",g=Math.round(w/l),y);if((g=s(b,m))<12)return v("xMonths",Math.round(w/l),y);var j=g%12,x=Math.floor(g/12);return j<3?v("aboutXYears",x,y):j<9?v("overXYears",x,y):v("almostXYears",x+1,y)}},783:function(e,t,n){var r=n(717);e.exports=function(e,t){var n=r(e).getTime(),a=r(t).getTime();return n>a?-1:n<a?1:0}},784:function(e,t,n){var r=n(785);e.exports=function(e,t){var n=r(e,t)/1e3;return n>0?Math.floor(n):Math.ceil(n)}},785:function(e,t,n){var r=n(717);e.exports=function(e,t){var n=r(e),a=r(t);return n.getTime()-a.getTime()}},786:function(e,t,n){var r=n(717),a=n(787),o=n(729);e.exports=function(e,t){var n=r(e),s=r(t),i=o(n,s),c=Math.abs(a(n,s));return n.setMonth(n.getMonth()-i*c),i*(c-(o(n,s)===-i))}},787:function(e,t,n){var r=n(717);e.exports=function(e,t){var n=r(e),a=r(t);return 12*(n.getFullYear()-a.getFullYear())+(n.getMonth()-a.getMonth())}},840:function(e,t,n){e.exports=n(841)},841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=i(a),s=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollListener=n.scrollListener.bind(n),n.eventListenerOptions=n.eventListenerOptions.bind(n),n.mousewheelListener=n.mousewheelListener.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}},{key:"componentDidUpdate",value:function(){if(this.props.isReverse&&this.loadMore){var e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}},{key:"componentWillUnmount",value:function(){this.detachScrollListener(),this.detachMousewheelListener()}},{key:"isPassiveSupported",value:function(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(n){}return e}},{key:"eventListenerOptions",value:function(){var e=this.props.useCapture;return this.isPassiveSupported()&&(e={useCapture:this.props.useCapture,passive:!0}),e}},{key:"setDefaultLoader",value:function(e){this.defaultLoader=e}},{key:"detachMousewheelListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}},{key:"detachScrollListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}},{key:"getParentElement",value:function(e){var t=this.props.getScrollParent&&this.props.getScrollParent();return null!=t?t:e&&e.parentNode}},{key:"filterProps",value:function(e){return e}},{key:"attachScrollListener",value:function(){var e=this.getParentElement(this.scrollComponent);if(this.props.hasMore&&e){var t=window;!1===this.props.useWindow&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}}},{key:"mousewheelListener",value:function(e){1!==e.deltaY||this.isPassiveSupported()||e.preventDefault()}},{key:"scrollListener",value:function(){var e=this.scrollComponent,t=window,n=this.getParentElement(e),r=void 0;if(this.props.useWindow){var a=document.documentElement||document.body.parentNode||document.body,o=void 0!==t.pageYOffset?t.pageYOffset:a.scrollTop;r=this.props.isReverse?o:this.calculateOffset(e,o)}else r=this.props.isReverse?n.scrollTop:e.scrollHeight-n.scrollTop-n.clientHeight;r<Number(this.props.threshold)&&e&&null!==e.offsetParent&&(this.detachScrollListener(),this.beforeScrollHeight=n.scrollHeight,this.beforeScrollTop=n.scrollTop,"function"===typeof this.props.loadMore&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}},{key:"calculateOffset",value:function(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}},{key:"calculateTopPosition",value:function(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}},{key:"render",value:function(){var e=this,t=this.filterProps(this.props),n=t.children,r=t.element,a=t.hasMore,s=(t.initialLoad,t.isReverse),i=t.loader,c=(t.loadMore,t.pageStart,t.ref),u=(t.threshold,t.useCapture,t.useWindow,t.getScrollParent,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["children","element","hasMore","initialLoad","isReverse","loader","loadMore","pageStart","ref","threshold","useCapture","useWindow","getScrollParent"]));u.ref=function(t){e.scrollComponent=t,c&&c(t)};var l=[n];return a&&(i?s?l.unshift(i):l.push(i):this.defaultLoader&&(s?l.unshift(this.defaultLoader):l.push(this.defaultLoader))),o.default.createElement(r,u,l)}}]),t}();c.propTypes={children:s.default.node.isRequired,element:s.default.node,hasMore:s.default.bool,initialLoad:s.default.bool,isReverse:s.default.bool,loader:s.default.node,loadMore:s.default.func.isRequired,pageStart:s.default.number,ref:s.default.func,getScrollParent:s.default.func,threshold:s.default.number,useCapture:s.default.bool,useWindow:s.default.bool},c.defaultProps={element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null},t.default=c,e.exports=t.default},842:function(e,t,n){var r=n(782);e.exports=function(e,t){return r(Date.now(),e,t)}},902:function(e,t,n){"use strict";n.r(t);var r=n(261),a=n(720),o=n.n(a),s=n(721),i=n(123),c=n(124),u=n(229),l=n(125),d=n(230),p=n(1),h=n.n(p),f=n(110),v=n(126),m=n(219),b=n(733),y=n(732),g=n.n(y),E=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.attendee;return h.a.createElement(f.p.Item,null,h.a.createElement(f.m,{as:b.a,to:"/profile/".concat(e.id),size:"mini",circular:!0,src:e.photoURL}))}}]),t}(p.Component),O=n(728),w=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.event;return h.a.createElement(f.t.Group,null,h.a.createElement(f.t,null,h.a.createElement(f.n.Group,null,h.a.createElement(f.n,null,h.a.createElement(f.n.Image,{size:"tiny",circular:!0,src:e.hostPhotoURL}),h.a.createElement(f.n.Content,null,h.a.createElement(f.n.Header,{as:b.a,to:"/event/".concat(e.id)},e.title),h.a.createElement(f.n.Description,null,"Hosted by ",h.a.createElement(b.a,{to:"/profile/".concat(e.hostUid)},e.hostedBy)),e.cancelled&&h.a.createElement(f.o,{style:{top:"-40px"},ribbon:"right",color:"red",content:"This event has been cancelled"}))))),h.a.createElement(f.t,null,h.a.createElement("span",null,h.a.createElement(f.l,{name:"clock"})," ",g()(e.date.toDate(),"dddd Do MMMM")," at ",g()(e.date.toDate(),"HH:mm")," |",h.a.createElement(f.l,{name:"marker"})," ",e.venue)),h.a.createElement(f.t,{secondary:!0},h.a.createElement(f.p,{horizontal:!0},e.attendees&&Object(O.c)(e.attendees).map(function(e){return h.a.createElement(E,{key:e.id,attendee:e})}))),h.a.createElement(f.t,{clearing:!0},h.a.createElement("span",null,e.description),h.a.createElement(f.a,{as:b.a,to:"/event/".concat(e.id),color:"teal",floated:"right",content:"View"})))}}]),t}(p.Component),j=n(840),x=n.n(j),L=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.events,n=e.getNextEvents,r=e.loading,a=e.moreEvents;return h.a.createElement("div",null,t&&0!==t.length&&h.a.createElement(x.a,{pageStart:0,loadMore:n,hasMore:!r&&a,initialLoad:!1},t&&t.map(function(e){return h.a.createElement(w,{key:e.id,event:e})})))}}]),t}(p.Component),k=n(734),M=n(58),S=n(842),C=n.n(S),P=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).renderSummary=function(e){switch(e.type){case"newEvent":return h.a.createElement("div",null,"New Event! "," ",h.a.createElement(f.h.User,{as:b.a,to:{pathname:"/profile/"+e.hostUid}},e.hostedBy)," "," ","is hosting "," ",h.a.createElement(b.a,{to:{pathname:"/event/"+e.eventId}},e.title));case"cancelledEvent":return h.a.createElement("div",null,"Event Cancelled! "," ",h.a.createElement(f.h.User,{as:b.a,to:{pathname:"/profile/"+e.hostUid}},e.hostedBy)," "," ","has cancelled "," ",h.a.createElement(b.a,{to:{pathname:"/event/"+e.eventId}},e.title));default:return}},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.activity;return h.a.createElement(f.h.Event,null,h.a.createElement(f.h.Label,null,h.a.createElement("img",{src:e.photoURL||"/assets/user.png",alt:""})),h.a.createElement(f.h.Content,null,h.a.createElement(f.h.Summary,null,this.renderSummary(e)),h.a.createElement(f.h.Meta,null,h.a.createElement(f.h.Date,null,C()(e.timestamp.toDate())," ago"))))}}]),t}(p.Component);var D=function(e){var t=e.activities,n=e.contextRef;return h.a.createElement(f.v,{context:n,offset:100},h.a.createElement(f.k,{attached:"top",content:"Recent Activity"}),h.a.createElement(f.t,{attached:!0},h.a.createElement(f.h,null,t&&t.map(function(e){return h.a.createElement(P,{key:e.id,activity:e})}))))},R={getEventsForDashboard:k.d},T=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={moreEvents:!1,loadingInitial:!0,loadedEvents:[],contextRef:{}},n.getNextEvents=Object(s.a)(o.a.mark(function e(){var t,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.events,r=t&&t[t.length-1],e.next=4,n.props.getEventsForDashboard(r);case 4:(a=e.sent)&&a.docs&&a.docs.length<=1&&n.setState({moreEvents:!1});case 6:case"end":return e.stop()}},e,this)})),n.handleContextRef=function(e){return n.setState({contextRef:e})},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.getEventsForDashboard();case 2:(t=e.sent)&&t.docs&&t.docs.length>1&&this.setState({moreEvents:!0,loadingInitial:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){this.props.events!==e.events&&this.setState({loadedEvents:[].concat(Object(r.a)(this.state.loadedEvents),Object(r.a)(e.events))})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.activities,r=this.state,a=r.moreEvents,o=r.loadedEvents;return this.state.loadingInitial?h.a.createElement(M.a,{inverted:!0}):h.a.createElement(f.j,null,h.a.createElement(f.j.Column,{width:10},h.a.createElement("div",{ref:this.handleContextRef},h.a.createElement(L,{loading:t,moreEvents:a,events:o,getNextEvents:this.getNextEvents}))),h.a.createElement(f.j.Column,{width:6},h.a.createElement(D,{activities:n,contextRef:this.state.contextRef})),h.a.createElement(f.j.Column,{width:10},h.a.createElement(f.q,{active:t})))}}]),t}(p.Component);t.default=Object(v.connect)(function(e){return{events:e.events,loading:e.async.loading,activities:e.firestore.ordered.activity}},R)(Object(m.firestoreConnect)([{collection:"activity",orderBy:["timestamp","desc"],limit:6}])(T))}}]);
//# sourceMappingURL=6.d90e7d18.chunk.js.map